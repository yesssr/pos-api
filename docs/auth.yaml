paths:
  /auth/login:
    post:
      summary: Login
      description: Authenticate user and receive JWT token
      tags:
        - auth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginRequest"
      responses:
        "200":
          description: Login successfully (data contains GetUserByUsernameRow and credentials contains the JWT string)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CredentialsResponse"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

components:
  schemas:
    LoginRequest:
      type: object
      required:
        - username
        - password
      properties:
        username:
          type: string
          example: admin
        password:
          type: string
          example: secret123

    CredentialsResponse:
      type: object
      description: Envelope returned by /auth/login (lib.Response with credentials token and sanitized user data)
      example:
        success: true
        status_code: 200
        message: Login successfully
        credentials: Bearer eyJhbGciOi.SomeJWTTokenExample
        data:
          id: 11111111-1111-1111-1111-111111111111
          username: admin
          password: ""
          role: admin
          image_url: https://cdn.example.com/images/admin.png
      properties:
        success:
          type: boolean
          example: true
        status_code:
          type: integer
          example: 200
        message:
          type: string
          example: Login successfully
        credentials:
          type: string
          nullable: true
          example: Bearer eyJhbGciOi.SomeJWTTokenExample
        data:
          description: Sanitized user object (password blank) returned from service.AuthService.Login
          $ref: "#/components/schemas/GetUserByUsernameRow"

    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        status_code:
          type: integer
          example: 400
        message:
          type: string
          example: Validation error
        data:
          nullable: true

    Roles:
      type: string
      enum:
        - admin
        - cashier
      example: admin

    GetUserByUsernameRow:
      type: object
      description: Raw user row fetched by AuthService (handler blanks password before returning)
      properties:
        id:
          type: string
          format: uuid
          example: 11111111-1111-1111-1111-111111111111
        username:
          type: string
          example: admin
        password:
          type: string
          description: Redacted (empty string) in responses
          example: ""
        role:
          $ref: "#/components/schemas/Roles"
        image_url:
          type: string
          example: https://cdn.example.com/images/admin.png
